# mis281n-assignment-2-ddl-script-basic-dml-solved
**TO GET THIS SOLUTION VISIT:** [MIS281N Assignment 2-DDL Script & Basic DML Solved](https://www.ankitcodinghub.com/product/mis281n-assignment-2-ddl-script-basic-dml-solved/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;91143&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;0&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;0&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;0\/5 - (0 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;MIS281N Assignment 2-DDL Script \u0026amp; Basic DML Solved&quot;,&quot;width&quot;:&quot;0&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 0px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            <span class="kksr-muted">Rate this product</span>
    </div>
    </div>
<u>Assignment 3 ‚Äì DDL Script &amp; Basic DML</u>

<strong>PART 1 ‚Äì DDL</strong>

Goal: In this assignment, you are tasked with creating a fully functioning DDL script that could be run to create a demo&nbsp;of your <strong>Hotel Reservation System database</strong> that you designed in&nbsp;the previous Database Design Assignment. Your script must not only build the database according to the requirements below but also seed it with some data for testing purposes. Lastly, your script must be able to run over and over, meaning it can drop database objects (e.g. tables, sequences, indexes), recreate those objects, and seed with test data in a single script.

&nbsp;

<h1>Assignment Requirements:</h1>
<h2><strong><u>Do your own work</u></strong></h2>
<ul>
<li>This is an individual assignment and you must do your own work and create your own DDL script based on a working/final version posted on Canvas HW2 instructions</li>
</ul>
<h2><strong><u>Coding Standards</u></strong></h2>
<ul>
<li><strong>Naming</strong>: Use the final ERD as a reference on how to name tables and columns. For constraints, make the names clear and easy to understand. Avoid abbreviations.</li>
<li><strong>Data Types / Lengths:</strong>
<ul>
<li><em>NUMBER</em> ‚Äì Follow the standard of making IDs numeric and any column that involves arithmetic.</li>
<li><em>VARCHAR ‚Äì </em>All non-numeric fields should be VARCHAR except fields mentioned in CHAR section below.</li>
<li><em>CHAR</em> ‚Äì Phone numbers will all be defined as CHAR length of 12 to allow for 10 digits and 2 dashes (e.g. 512-999-1234). State is the abbreviation of a state so its CHAR length of 2. Zipcode only needs to store a length of 5. CardType on the payments table will always be 4 character abbreviations of cards. Confirmation number will always be 8 characters of random letters/numbers. Reservation status is used to track a simple U for <em>Upcoming</em>, I for <em>In Progress</em>, C for <em>Completed</em>, N for <em>No-show</em>, R for <em>Refunded</em> so this is always a length of 1. The Room Type will also store a single character for the following room types: D for double beds, Q for single queen, K for single king, S for suite that has two rooms and some form of kitchen, C for cabin.</li>
<li><em>DATE </em>‚Äì Any dates fields should be DATE format</li>
<li>Note: Lengths can vary unless specified above.</li>
</ul>
</li>
<li><strong>Commenting</strong>
<ul>
<li>Include comments at least with each section of code (i.e. DROP, CREATE, INSERT, INDEXES)</li>
<li>Comments should include a description of section and your name/uteid as the author.</li>
<li>If you want to add additional comments to single statements or lines feel free but it‚Äôs not required. It‚Äôs just a best practice to comment code well.</li>
</ul>
</li>
</ul>
&nbsp;

<h2><strong><u>Constraints</u></strong></h2>
<ul>
<li>Assign primary and foreign keys per the design.</li>
<li>Only the following can be NULL: <em>Address_line_2</em> since it‚Äôs not required. Customer<em>s‚Äô birthdates </em>since it‚Äôs not always known. The reservation<em> Checkout Date</em>, <em>Discount Code</em>, <em>Customer Rating</em>, and <em>Notes </em>are also not required since they are allowed to be blank when the reservation is created. Note, if you see other fields that could be nullable, please clarify these assumptions on Slack.</li>
<li>The following fields should be UNIQUE: <em>Customer email, Feature Name, Location Name,</em> and <em>Confirmation Number</em>. <em>Customer_ID</em> on payments should also be unique to force it to be a 1-to-1. Again, if you find other potential non-primary keys, bring this up on Slack.&nbsp; Also we need a composite unique constraint on Room table for the <em>location_id</em> and <em>room_number</em> to prevent duplicate rooms at a location.&nbsp; If you see a need for more non-primary key constraints, please raise that on Slack.</li>
<li>DEFAULTS:
<ul>
<li>Stay credits earned and used should be set initially to 0 (zero).</li>
<li>The reservation <em>Date_Created</em> should default to the current date using the SYSDATE function. I know‚Ä¶we didn‚Äôt cover this in class but you can figure this out if you dig a little in your book or online. You can do it!</li>
</ul>
</li>
</ul>
&nbsp;

<ul>
<li>Make sure the following Check constraints are added:
<ul>
<li>Reservation status as of now can only be the following values detailed above: U, I, C, N, or R.</li>
<li>The Room Type as of now can only be the following values detailed above: D, Q, K, S, or C.</li>
<li>Stay Credits Used should never be greater than the Stay Credits Earned</li>
<li>Customer Emailed ‚Äì emails should have a character length of at least 7 or more. Again, just because we didn‚Äôt cover it in class doesn‚Äôt mean you can‚Äôt google it and figure it out. Name this constraint ‚Äúemail_length_check‚Äù.</li>
</ul>
</li>
</ul>
<h2><strong><u>Other</u></strong></h2>
<ul>
<li>Create indexes on all foreign keys that are not also part of a primary key. Since primary keys are indexed we won‚Äôt index a column that is both a PK and FK. Also, index at least 2 other fields in the schema to show you can properly discern which columns should have indexes per design rules discussed in class</li>
<li>Create sequences that auto-increment the <em>payment_id, reservation_id, room_id, location_id, and feature_id </em>by 1 starting at 1. Create a sequence for <em>customer_id</em> that increments by 1 starting at 100001.</li>
</ul>
<h2><strong><u>Format </u></strong></h2>
<ul>
<li><strong>Easy to Read Code:</strong> All your code should be well spaced and indented. If it‚Äôs not easy to read and messy, you could lose points.</li>
<li><strong>Sections</strong>: You must create your script with the three following sections:
<ul>
<li>Drop Sequence/Tables section ‚Äì Area of the script that drops all tables and sequences in proper order</li>
<li>Create Sequence/Tables section ‚Äì Area of the script that creates tables/sequences and adds constraints either via CREATE or ALTER TABLE statements</li>
<li>Insert Data section ‚Äì Area of the script that inserts data into the tables using ‚ÄúINSERT INTO‚Äù</li>
<li>Create Index section ‚Äì After you seed data, add in indexes for the database to optimize performance</li>
</ul>
</li>
<li><strong>Commenting</strong>: You should add comments before each section that includes a <em>description</em> of what is happening in that section and <em>your name and UTEID</em>, which is a best practice to know who coded what.</li>
<li>The script must build the database shown in the ERD exactly which means table names, column names, and constraints must match. That being said, we are not going to specify the exact names of constraints that you create unless stated above. Just be sure to use logical, clear names for constraints.</li>
</ul>
&nbsp;

<h2><strong><u>Data Requirements</u></strong></h2>
Seed your tables based on the following requirement: NOTE: <strong><u>Include commits</u></strong> after each group of inserts for a particular table and don‚Äôt forget to regularly commit to avoid taxing the server and causing <a href="https://stackoverflow.com/questions/4842765/ora-00054-resource-busy-and-acquire-with-nowait-specified-or-timeout-expired">NOWAIT error</a>.

<ul>
<li>Create the 3 locations mentioned in HW1 and make-up details on address, phone, and URL.</li>
<li>Create up to 3 features that can be shared or unique to the locations but make sure at least one location has multiple features assigned to it</li>
<li>Create 2 rooms for each location (even though in reality there should be more)</li>
<li>Create 2 customers that have payments attached. The first customer should have <strong>your</strong> first and last name. Their email should be your uteid + ‚Äúutexas.edu‚Äù. (e.g. abd123@utexas.edu). The rest of the data about you can be fake. Make up data for the 2<sup>nd</sup></li>
<li>For your customer account, create a single room reservation. For the 2<sup>nd</sup>, create two separate reservations that are on different dates.</li>
<li>NOTE: If you need to clarify any data requirements, ask on Slack.</li>
</ul>
&nbsp;

<h2><strong><u>Testing before you turn in your work</u></strong></h2>
<ul>
<li>Make sure your script runs without errors before you submit it. Test it by dropping all the tables and running the script. Then run the script to ensure no unexpected errors occur.</li>
</ul>
&nbsp;

<strong><u>What to turn in</u></strong>

<ul>
<li>Turn in your DDL script in a (.sql) file format. If you have issues doing this, at least save it as a .txt file. Do not submit in any other format other than .sql and .txt</li>
</ul>
&nbsp;

<strong>PART 2 ‚Äì DML</strong>

<h1>Instructions:</h1>
<ul>
<li><strong>Do your own work: </strong>This is an individual assignment and you must do your own work and create your own SQL statements. If you are caught cheating on this or using someone else‚Äôs work, you will receive a zero on this assignment and be reported to the Dean of Students. Also, this homework prepares you for the exam coming up so doing the work now will help you learn and do well on when it counts more.</li>
<li><strong><u>What to turn in</u></strong>
<ul>
<li>Clearly separate your code for each question. Save your code into one SQL file with the naming format: LastName_FirstName_UTEid. Please make sure the lastname and firstname you use matches what is in Canvas.</li>
<li><strong>Save your file either as a .sql file or as a .txt file. If you need help doing this, refer to the page linked in the Canvas assignment. Files saved in a different format will be 50% and files in a different format that cannot be read into SQL (example: PDF) will result in a 0%.</strong></li>
<li>Submit your .sql file on Canvas before the deadline. Late submissions receive 50% off. No submissions will be accepted 24 hours after the deadline.</li>
<li>Do not include the DDL in your submission. If you do, you will lose 5 points. Only provide SQL with comments and nothing else. Do this going forward on all other assignments unless noted.</li>
</ul>
</li>
<li>The SQL problems below will be based on the DDL script that is posted on the Canvas instructions. Download that script and run it before you start.</li>
</ul>
&nbsp;

<h1>Problems:</h1>
<ol>
<li>Write a SELECT statement that returns following columns from the <em>Title </em>table: genre, title, publisher, number_of_pages. Then, run this statement to make sure it works correctly.</li>
</ol>
Add an ORDER BY clause to this statement that sorts the result set by number_of_pages in ascending order. Then, run this statement again to make sure it works correctly. This is a good way to build and test a statement, one clause at a time.

&nbsp;

<ol start="2">
<li>Write a SELECT statement that returns one column from the <em>Author</em> table named author_full_name that combines the first_name and last_name columns. Leave out middle name for now.</li>
</ol>
Format this column with the first name, a space, and last name like this:

Michael Jordan

Sort the result set by last name in descending sequence.

Use the ‚ÄúIN‚Äù operator to return only the authors whose first name begins with letters of A, B, or C.

&nbsp;

<ol start="3">
<li>Write a SELECT statement that returns these columns from the <em>Checkouts</em> patron_id, title_copy_id, date_out, due_back_date, and date_in. Return only the rows for checkouts that went out in Feb 2021. That means to filter where only date_out between the beginning Feb 1<sup>st</sup> and Feb 28<sup>th</sup>.&nbsp; Use the BETWEEN operator. Sort the result by date_in and the date_out so we can see which are in first and then which are not in.</li>
<li>Create a duplicate of the previous query but this time update the WHERE clause to use only the following operators (&lt;, &gt;, &lt;=, or &gt;=). Keep the rest of the query the same.</li>
</ol>
&nbsp;

<ol start="5">
<li>Write a SELECT statement that returns these column names and data from the <strong><em>Checkouts </em></strong>table:</li>
</ol>
checkout_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The checkout_id column

title_copy_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The title_copy_id column

renewals_left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is calculated as 2 minus the times_renewed.&nbsp; Assign an alias of <strong>renewals_left</strong>

Use the <a href="https://docs.oracle.com/cd/B19306_01/server.102/b14200/pseudocolumns009.htm">ROWNUM pseudo column</a> so the result set contains only the first 5 rows from the table.

Sort the result set by the column alias <strong>renewals_left</strong> in ascending order.

&nbsp;

<ol start="6">
<li>Write a SELECT statement that returns the title and genre from Title table and also a third column called ‚ÄúBook_Level‚Äù. The book level is calculated by dividing the number_of_pages by 100 and the rounding it to have 1 decimal.&nbsp; So a book that is around 100 pages would be a level 1, ea book that is 500 pages would be level 5, etc‚Ä¶&nbsp; Once you have this filter to only show books that are greater than a level 9</li>
</ol>
&nbsp;

&nbsp;

<ol start="7">
<li>Write a SELECT statement that returns these columns from the <em>Author</em>: first_name, middle_name, last_name. Return only rows for users that have a value in middle_name using a NULL operator. Sort by column positions 2 and then 3 in ascending order</li>
</ol>
&nbsp;

<ol start="8">
<li>Using the <a href="https://www.geeksforgeeks.org/dual-table-in-sql/">DUAL table</a> write a SELECT statement that uses SYSDATE function to create a row with these columns:</li>
</ol>
today_unformatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The SYSDATE function unformatted

today_formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The SYSDATE function in this format: MM/DD/YYYY

This displays a number for the month, a number for the day, and a four-digit year. Use a FROM clause that specifies the Dual table. <em>Hint: You will need to implement the </em><a href="https://www.techonthenet.com/oracle/functions/to_char.php"><em>TO_CHAR function</em></a><em> to format the sysdate in the format designated above.</em>

&nbsp;

After you write this add the following columns to the row:

Days_Late&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5

Late_fee&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .25

Total_late_fees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 * .25

Late_fees_until_lock&nbsp;&nbsp;&nbsp;&nbsp; 5-(5*.25).&nbsp; This assumes that after you accrue $5 in late fees, your account locks

&nbsp;

Your result table contains only one row.

&nbsp;

&nbsp;

<ol start="9">
<li>Write a query that returns a distinct list of genres form the title table sorted by genre ascending</li>
</ol>
&nbsp;

&nbsp;

<ol start="10">
<li>Write a query that returns all the rows from <em>Titles </em>for books that contains the word ‚ÄòBird‚Äô. The problem is that we don‚Äôt know if the word will be capitalized in the title or not so in your where clause use the LOWER() function to compare the lowercase version of title to filter only rows that contain the word ‚Äòbird‚Äô</li>
</ol>
&nbsp;
